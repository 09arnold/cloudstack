<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>13.2. Primary Storage</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 2.8" /><meta name="package" content="Apache_CloudStack-Admin_Guide-4.0.0-incubating-en-US-1-" /><link rel="home" href="index.html" title="CloudStack Administrator's Guide" /><link rel="up" href="storage.html" title="Chapter 13. Working With Storage" /><link rel="prev" href="storage-overview.html" title="13.1. Storage Overview" /><link rel="next" href="secondary-storage.html" title="13.3. Secondary Storage" /></head><body><p id="title"><a class="left" href="http://cloudstack.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://docs.cloudstack.org"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="storage-overview.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="secondary-storage.html"><strong>Next</strong></a></li></ul><div xml:lang="en-US" class="section" id="primary-storage" lang="en-US"><div class="titlepage"><div><div><h2 class="title" id="primary-storage">13.2. Primary Storage</h2></div></div></div><div class="para">
		This section gives concepts and technical details about CloudStack primary storage. For information about how to install and configure primary storage through the CloudStack UI, see the Installation Guide.
	</div><div class="para">
		<a class="xref" href="about-primary-storage.html">Section 2.5, “About Primary Storage”</a>
	</div><div xml:lang="en-US" class="section" id="best-practices-primary-storage" lang="en-US"><div class="titlepage"><div><div><h3 class="title" id="best-practices-primary-storage">13.2.1. Best Practices for Primary Storage</h3></div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				The speed of primary storage will impact guest performance. If possible, choose smaller, higher RPM drives for primary storage.
			</div></li><li class="listitem"><div class="para">
				Ensure that nothing is stored on the server. Adding the server to CloudStack will destroy any existing data
			</div></li></ul></div></div><div xml:lang="en-US" class="section" id="runtime-behavior-of-primary-storage" lang="en-US"><div class="titlepage"><div><div><h3 class="title" id="runtime-behavior-of-primary-storage">13.2.2. Runtime Behavior of Primary Storage</h3></div></div></div><div class="para">
		Root volumes are created automatically when a virtual machine is created. Root volumes are deleted when the VM is destroyed. Data volumes can be created and dynamically attached to VMs.  Data volumes are not deleted when VMs are destroyed.
	</div><div class="para">
		Administrators should monitor the capacity of primary storage devices and add additional primary storage as needed. See the Advanced Installation Guide.
	</div><div class="para">
		Administrators add primary storage to the system by creating a CloudStack storage pool. Each storage pool is associated with a cluster.
	</div></div><div xml:lang="en-US" class="section" id="hypervisor-support-for-primarystorage" lang="en-US"><div class="titlepage"><div><div><h3 class="title" id="hypervisor-support-for-primarystorage">13.2.3. Hypervisor Support for Primary Storage</h3></div></div></div><div class="para">
		The following table shows storage options and parameters for different hypervisors.
	</div><div class="informaltable"><table border="1"><colgroup><col width="33%" class="c1" /><col width="4cm" class="c2" /><col width="5cm" class="c3" /><col width="33%" class="c4" /><col width="33%" class="c5" /></colgroup><thead><tr><th>
					</th><th>
						<div class="para">
							VMware vSphere
						</div>
					</th><th>
						<div class="para">
							Citrix XenServer
						</div>
					</th><th>
						<div class="para">
							KVM
						</div>
					</th><td class="auto-generated"> </td></tr></thead><tbody><tr><td>
						<div class="para">
							<span class="bold bold"><strong><span class="bold bold"><strong>Format for Disks, Templates, and Snapshots</strong></span></strong></span>
						</div>
					</td><td>
						<div class="para">
							VMDK
						</div>
					</td><td>
						<div class="para">
							VHD
						</div>
					</td><td>
						<div class="para">
							QCOW2
						</div>
					</td><td class="auto-generated"> </td></tr><tr><td>
						<div class="para">
							<span class="bold bold"><strong>iSCSI support</strong></span>
						</div>
					</td><td>
						<div class="para">
							VMFS
						</div>
					</td><td>
						<div class="para">
							Clustered LVM
						</div>
					</td><td>
						<div class="para">
							Yes, via Shared Mountpoint
						</div>
					</td><td class="auto-generated"> </td></tr><tr><td>
						<div class="para">
							<span class="bold bold"><strong>Fiber Channel support</strong></span>
						</div>
					</td><td>
						<div class="para">
							VMFS
						</div>
					</td><td>
						<div class="para">
							Yes, via Existing SR
						</div>
					</td><td>
						<div class="para">
							Yes, via Shared Mountpoint
						</div>
					</td><td class="auto-generated"> </td></tr><tr><td>
						<div class="para">
							<span class="bold bold"><strong>NFS support</strong></span>
						</div>
					</td><td>
						<div class="para">
							Y
						</div>
					</td><td>
						<div class="para">
							Y
						</div>
					</td><td>
						<div class="para">
							Y
						</div>
					</td><td class="auto-generated"> </td></tr><tr><td>
						<div class="para">
							<span class="bold bold"><strong>Local storage support</strong></span>
						</div>
					</td><td>
						<div class="para">
							Y
						</div>
					</td><td>
						<div class="para">
							Y
						</div>
					</td><td>
						<div class="para">
							Y
						</div>
					</td><td class="auto-generated"> </td></tr><tr><td>
						<div class="para">
							<span class="bold bold"><strong>Storage over-provisioning</strong></span>
						</div>
					</td><td>
						<div class="para">
							NFS and iSCSI
						</div>
					</td><td>
						<div class="para">
							NFS
						</div>
					</td><td>
						<div class="para">
							NFS
						</div>
					</td><td class="auto-generated"> </td></tr></tbody></table></div><div class="para">
		XenServer uses a clustered LVM system to store VM images on iSCSI and Fiber Channel volumes and does not support over-provisioning in the hypervisor. The storage server itself, however, can support thin-provisioning. As a result the CloudStack can still support storage over-provisioning by running on thin-provisioned storage volumes.
	</div><div class="para">
		KVM supports "Shared Mountpoint" storage. A shared mountpoint is a file system path local to each server in a given cluster. The path must be the same across all Hosts in the cluster, for example /mnt/primary1. This shared mountpoint is assumed to be a clustered filesystem such as OCFS2. In this case the CloudStack does not attempt to mount or unmount the storage as is done with NFS. The CloudStack requires that the administrator insure that the storage is available
	</div><div class="para">
		With NFS storage, CloudStack manages the overprovisioning. In this case the global configuration parameter storage.overprovisioning.factor controls the degree of overprovisioning. This is independent of hypervisor type.
	</div><div class="para">
		Local storage is an option for primary storage for vSphere, XenServer, and KVM. When the local disk option is enabled, a local disk storage pool is automatically created on each host. To use local storage for the System Virtual Machines (such as the Virtual Router), set system.vm.use.local.storage to true in global configuration.
	</div><div class="para">
		CloudStack supports multiple primary storage pools in a Cluster. For example, you could provision 2 NFS servers in primary storage. Or you could provision 1 iSCSI LUN initially and then add a second iSCSI LUN when the first approaches capacity.
	</div></div><div xml:lang="en-US" class="section" id="storage-tags" lang="en-US"><div class="titlepage"><div><div><h3 class="title" id="storage-tags">13.2.4. Storage Tags</h3></div></div></div><div class="para">
		Storage may be "tagged". A tag is a text string attribute associated with primary storage, a Disk Offering, or a Service Offering. Tags allow administrators to provide additional information about the storage. For example, that is a "SSD" or it is "slow". Tags are not interpreted by CloudStack. They are matched against tags placed on service and disk offerings. CloudStack requires all tags on service and disk offerings to exist on the primary storage before it allocates root or data disks on the primary storage. Service and disk offering tags are used to identify the requirements of the storage that those offerings have. For example, the high end service offering may require "fast" for its root disk volume.
	</div><div class="para">
		The interaction between tags, allocation, and volume copying across clusters and pods can be complex. To simplify the situation, use the same set of tags on the primary storage for all clusters in a pod. Even if different devices are used to present those tags, the set of exposed tags can be the same.
	</div></div><div xml:lang="en-US" class="section" id="maintenance-mode-for-primary-storage.xml" lang="en-US"><div class="titlepage"><div><div><h3 class="title" id="maintenance-mode-for-primary-storage.xml">13.2.5. Maintenance Mode for Primary Storage</h3></div></div></div><div class="para">
		Primary storage may be placed into maintenance mode. This is useful, for example, to replace faulty RAM in a storage device. Maintenance mode for a storage device will first stop any new guests from being provisioned on the storage device. Then it will stop all guests that have any volume on that storage device. When all such guests are stopped the storage device is in maintenance mode and may be shut down. When the storage device is online again you may cancel maintenance mode for the device. The CloudStack will bring the device back online and attempt to start all guests that were running at the time of the entry into maintenance mode.
	</div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="storage-overview.html"><strong>Prev</strong>13.1. Storage Overview</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="secondary-storage.html"><strong>Next</strong>13.3. Secondary Storage</a></li></ul></body></html>
